{% extends "base.html" %}
{% block content %}
<div class="max-w-5xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
  <!-- ì œëª© -->
  <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2">
    <span>ê´‘ê³  ê´€ë¦¬</span>
  </h2>

  <!-- ë“±ë¡ í¼ -->
  <form method="POST" enctype="multipart/form-data"
        class="space-y-5 bg-white border border-gray-200 shadow-md rounded-2xl p-6 sm:p-8 hover:shadow-lg transition-shadow duration-300">

    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-1">ì œëª© *</label>
      <input type="text" name="title" placeholder="ê´‘ê³  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
             class="w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 p-2.5"
             required>
    </div>

    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-1">ë¶€ì œëª©</label>
      <input type="text" name="subtitle" placeholder="ê´‘ê³  ë¶€ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
             class="w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 p-2.5">
    </div>

    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-1">ì„¤ëª…</label>
      <textarea name="description" rows="3" placeholder="ê´‘ê³  ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                class="w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 p-2.5"></textarea>
    </div>

    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-1">ë§í¬ URL</label>
      <input type="url" name="link_url" placeholder="https://example.com"
             class="w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 p-2.5">
    </div>

    <div>
      <label class="block text-sm font-semibold text-gray-700 mb-1">ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
      <input type="file" name="images" accept="image/*" multiple
             class="w-full border border-gray-300 rounded-lg p-2.5 cursor-pointer bg-gray-50 hover:bg-gray-100 transition">
      <p class="text-xs text-gray-500 mt-1">ê¶Œì¥ í¬ê¸°: <strong>350 Ã— 320px</strong></p>
    </div>

    <div class="pt-3">
      <button type="submit"
              class="w-full sm:w-auto px-6 py-2.5 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition font-semibold">
        ë“±ë¡í•˜ê¸°
      </button>
    </div>
  </form>

  <!-- ê´‘ê³  ëª©ë¡ -->
  <div class="mt-14">
    <h3 class="text-xl font-semibold mb-4 text-gray-800 border-b pb-2">ë“±ë¡ëœ ê´‘ê³  ëª©ë¡</h3>

    {% if ads %}
    <ul class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for ad in ads %}
      <li class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition p-4 flex flex-col">
        <!-- ì´ë¯¸ì§€ ëª©ë¡ -->
        <div class="flex flex-wrap gap-2 mb-4 justify-start">
          {% for img in ad.images %}
            <img src="{{ url_for('admin_ad_image', image_id=img.id) }}"
                 alt="{{ ad.title }}"
                 class="w-24 h-24 object-cover rounded-md border border-gray-300">
          {% endfor %}
        </div>

        <!-- ê´‘ê³  ì •ë³´ -->
        <div class="flex-1">
          <h4 class="font-bold text-lg text-gray-800">{{ ad.title }}</h4>
          {% if ad.subtitle %}
            <p class="text-sm text-gray-600 mt-1">{{ ad.subtitle }}</p>
          {% endif %}
          {% if ad.description %}
            <p class="text-xs text-gray-500 mt-1 line-clamp-2">{{ ad.description }}</p>
          {% endif %}
          {% if ad.link_url %}
            <a href="{{ ad.link_url }}" target="_blank" class="inline-block mt-2 text-blue-600 text-sm hover:underline">ğŸ”— ë§í¬ ë³´ê¸°</a>
          {% endif %}
        </div>

        <!-- ë²„íŠ¼ ì˜ì—­ -->
        <div class="flex justify-between mt-4">
          <form method="POST" action="{{ url_for('toggle_ad', ad_id=ad.id) }}">
            <button class="px-3 py-1.5 text-sm rounded-md font-medium transition
                           {{ 'bg-green-500 hover:bg-green-600 text-white' if ad.is_active else 'bg-gray-400 hover:bg-gray-500 text-white' }}">
              {{ 'í™œì„±í™”ë¨' if ad.is_active else 'ë¹„í™œì„±í™”' }}
            </button>
          </form>
          <form method="POST" action="{{ url_for('delete_ad', ad_id=ad.id) }}">
            <button class="px-3 py-1.5 text-sm bg-red-500 hover:bg-red-600 text-white rounded-md font-medium transition">
              ì‚­ì œ
            </button>
          </form>
        </div>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-center text-gray-500 py-10 bg-white rounded-lg border border-gray-200">
      ë“±ë¡ëœ ê´‘ê³ ê°€ ì—†ìŠµë‹ˆë‹¤.
    </p>
    {% endif %}
  </div>
</div>
{% endblock %}
