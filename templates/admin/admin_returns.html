{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto bg-white p-6 rounded shadow mt-8">
  <h2 class="text-2xl font-bold mb-6">반품 / 교환 요청 관리</h2>

  {% if return_orders|length == 0 %}
    <p class="text-gray-500 text-center py-10">현재 접수된 요청이 없습니다.</p>
  {% else %}
    <div class="overflow-x-auto">
      <table class="w-full text-sm border border-gray-200">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-3 py-2 border">주문번호</th>
            <th class="px-3 py-2 border">회원명</th>
            <th class="px-3 py-2 border">상태</th>
            <th class="px-3 py-2 border">주문일</th>
            <th class="px-3 py-2 border">관리</th>
          </tr>
        </thead>
        <tbody>
          {% for r in return_orders %}
          <tr class="border-t hover:bg-gray-50">
            <td class="px-3 py-2 text-center">{{ r.order_id }}</td>          {# 주문번호 표시는 order_id #}
            <td class="px-3 py-2 text-center">{{ r.user.name if r.user else "비회원" }}</td>
            <td class="px-3 py-2 text-center text-indigo-600 font-semibold">{{ r.status }}</td>
            <td class="px-3 py-2 text-center">{{ r.created_at|kst }}</td>
            <td class="px-3 py-2 text-center">
              <form method="post" class="inline">
                <input type="hidden" name="return_id" value="{{ r.id }}">  {# ← 요청 id 전송 #}
                <input type="hidden" name="action" value="approve">
                <button type="submit" class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 text-xs">승인</button>
              </form>
              <form method="post" class="inline">
                <input type="hidden" name="return_id" value="{{ r.id }}">  {# ← 요청 id 전송 #}
                <input type="hidden" name="action" value="reject">
                <button type="submit" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 text-xs">거절</button>
              </form>
              <form method="post" class="inline">
                <input type="hidden" name="return_id" value="{{ r.id }}">
                <input type="hidden" name="action" value="complete">
                <button type="submit" class="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 text-xs">처리완료</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</div>
{% endblock %}