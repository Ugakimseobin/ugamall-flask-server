{% extends "base.html" %}
{% block content %}
<div class="max-w-md mx-auto p-6 sm:p-8 bg-white shadow-lg rounded mt-10">
  <h2 class="text-2xl sm:text-3xl font-bold mb-6 text-center text-gray-600">
    {{ _("비밀번호 재설정") }}
  </h2>

  <form method="post" id="reset-request-form" class="space-y-4 text-sm sm:text-base">
    <div>
      <label class="block font-semibold mb-1">{{ _("가입 이메일") }}</label>
      <input type="email" id="reset-email" name="email" placeholder="{{ _('가입 시 사용한 이메일을 입력하세요') }}"
             required
             class="w-full border p-2 rounded focus:ring-2 focus:ring-indigo-400">
    </div>

    <button type="submit" id="send-btn"
            class="w-full bg-indigo-600 text-white py-2 rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center justify-center">
      <span>메일 보내기</span>
    </button>
  </form>

  <!-- 안내 문구 -->
  <p class="mt-6 text-xs text-gray-500 text-center leading-relaxed">
    {{ _("입력하신 이메일 주소로 비밀번호 재설정 링크가 전송됩니다.") }}<br>
    {{ _("메일이 오지 않았다면 스팸함을 확인해주세요.") }}
  </p>
</div>

<script>
document.getElementById("reset-request-form").addEventListener("submit", function(e) {
  const btn = document.getElementById("send-btn");
  const email = document.getElementById("reset-email").value.trim();

  if (!email) {
    e.preventDefault();
    alert("이메일을 입력해주세요.");
    return;
  }

  // ✅ 버튼 비활성화 및 로딩 표시
  btn.disabled = true;
  btn.innerHTML = `
    <span>메일 전송 중...</span>
    <div class="loading-spinner ml-2"></div>
  `;

  // ✅ 서버 응답 기다릴 때 사용자 피드백 유지
  setTimeout(() => {
    btn.innerHTML = `<span>메일 보내기</span>`;
    btn.disabled = false;
  }, 6000); // 6초 뒤 복귀 (안정적 UX)
});
</script>

<!-- ✅ 스피너 스타일 -->
<style>
.loading-spinner {
  border: 2px solid #f3f3f3;
  border-top: 2px solid #4f46e5;
  border-radius: 50%;
  width: 16px;
  height: 16px;
  animation: spin 0.8s linear infinite;
  display: inline-block;
  vertical-align: middle;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
{% endblock %}
