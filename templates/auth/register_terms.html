{% extends "base.html" %}
{% block content %}
<div class="max-w-xl mx-auto p-6 sm:p-8 bg-white shadow-2xl rounded-2xl mt-14 border border-gray-100">
  <!-- 헤더 -->
  <div class="text-center mb-8">
    <h2 class="text-3xl font-extrabold text-[#222] mb-2">{{ _("이용약관 동의") }}</h2>
    <p class="text-gray-500 text-sm sm:text-base">
      {{ _("회원가입을 위해 아래 약관에 동의해주세요.") }}
    </p>
  </div>

  <!-- 약관 폼 -->
  <form method="post" class="space-y-5 text-sm sm:text-base">
    <!-- 전체 동의 -->
    <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-100 flex items-center justify-between hover:bg-indigo-100 transition">
      <label class="flex items-center font-semibold text-indigo-800 text-lg cursor-pointer">
        <input type="checkbox" id="agree_all"
               class="w-5 h-5 mr-2 accent-indigo-600 cursor-pointer">
        {{ _("모두 동의합니다") }}
      </label>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    </div>

    <hr class="my-4">

    <!-- ✅ 약관 항목들 -->
    <div class="space-y-3">
      {% set terms_list = [
        ('agree_terms', _('유가몰 구매회원 이용약관 (필수)'), 'terms1', True),
        ('agree_finance', _('전자금융서비스 이용약관 동의 (필수)'), 'terms2', True),
        ('agree_privacy', _('개인정보 수집 및 이용동의 (필수)'), 'terms3', True),
        ('agree_age', _('만 14세 이상입니다. (필수)'), 'terms4', True),
        ('agree_marketing', _('혜택 알림 이메일, 문자, 앱 푸시 수신 (선택)'), 'terms5', False)
      ] %}
      
      {% for name, label, key, required in terms_list %}
      <div class="flex justify-between items-center bg-gray-50 border border-gray-200 rounded-lg p-3 hover:shadow-sm transition">
        <label class="flex-1 flex items-center cursor-pointer">
          <input type="checkbox" name="{{ name }}" class="agree-item w-4 h-4 accent-indigo-600 mr-3 cursor-pointer" {% if required %}required{% endif %}>
          <span class="{% if required %}text-gray-800{% else %}text-gray-600{% endif %}">
            {{ _(label) }}
          </span>
        </label>
        <button type="button" class="text-gray-400 hover:text-gray-500 text-sm font-medium underline"
                onclick="openModal('{{ key }}')">
          {{ _("보기") }}
        </button>
      </div>
      {% endfor %}
    </div>

    <!-- 다음 단계 버튼 -->
    <div class="mt-8">
      <button type="submit"
              class="w-full py-3 btn-dark text-white rounded-lg font-semibold hover:opacity-90 active:scale-[0.98] transition-all shadow-md">
        {{ _("다음 단계로 이동") }}
      </button>
    </div>
  </form>
</div>

<!-- 🌙 약관 모달 -->
<div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 transition-all">
  <div class="bg-white rounded-xl shadow-2xl max-w-lg w-11/12 sm:w-full p-6 relative animate-fadeIn">
    <h3 id="modal-title" class="text-xl font-bold mb-4 text-indigo-700 flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V4a2 2 0 10-4 0v1.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0a3 3 0 01-6 0" />
      </svg>
      {{ _("약관 상세보기") }}
    </h3>
    <div id="modal-content" class="h-64 overflow-y-auto border rounded p-4 text-sm leading-relaxed bg-gray-50 text-gray-700 shadow-inner"></div>
    <button onclick="closeModal()" class="absolute top-3 right-4 text-gray-400 hover:text-gray-600 text-2xl leading-none">&times;</button>
    <div class="text-right mt-5">
      <button onclick="closeModal()" class="px-6 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 shadow">
        {{ _("닫기") }}
      </button>
    </div>
  </div>
</div>

<!-- ✅ JS -->
<script>
  const agreeAll = document.getElementById("agree_all");
  const items = document.querySelectorAll(".agree-item");

  // 전체 동의 → 개별 체크 반영
  agreeAll.addEventListener("change", function() {
    items.forEach(chk => chk.checked = this.checked);
  });

  // 개별 체크 → 전체 동의 상태 반영
  items.forEach(chk => {
    chk.addEventListener("change", () => {
      agreeAll.checked = [...items].every(i => i.checked);
    });
  });

  // 약관 내용 (샘플)
  const termsData = {
        terms1: `【유가몰 구매회원 이용약관(요약)】
본 약관은 주식회사 유가(이하 ‘회사’)과 구매회원(이하 ‘회원’) 간의 상품 구매·결제·배송·교환/환불 등 전자상거래 서비스 이용에 관한 권리와 의무를 규정합니다.

1. 서비스 및 회원
• 회원: 회원가입을 완료하고 회사의 쇼핑 서비스를 통해 실제 구매를 진행하는 자
• 서비스: 상품 검색/주문/결제/배송 조회/문의/환불/포인트·쿠폰 등 부가 서비스

2. 주문 및 계약의 성립
• 상품 상세/가격/배송비/할인 등이 표시되며, 회원의 결제 완료 시 구매계약이 성립합니다.
• 단, 재고 부족/표시 오류/시스템 문제 등 불가피한 사유가 있는 경우 회사는 주문을 취소/거절할 수 있으며, 이 경우 이미 결제된 금액은 지체 없이 환불됩니다.

3. 가격/할인/쿠폰
• 표시가격에는 부가세가 포함될 수 있습니다(페이지 표기 기준).
• 쿠폰/프로모션은 각 조건(유효기간, 최소 구매금액, 적용 대상 등)에 따르며, 사용 후 주문 취소 시 복구 조건은 이벤트별 안내를 따릅니다.

4. 결제
• 지원 수단: 카드, 계좌이체, 가상계좌, 간편결제 등(페이지에 고지된 범위)
• 타인 명의 결제, 도용 및 불법 거래는 금지되며, 관련 법령에 따라 민·형사상 책임이 발생할 수 있습니다.

5. 배송
• 결제 완료 후 안내된 기간 내 발송을 원칙으로 하되, 천재지변/물류사정 등으로 지연될 수 있습니다. 지연 시 회사는 회원에게 고지합니다.
• 배송비, 추가비용(도서산간 등)은 상품/주소지에 따라 달라질 수 있습니다.

6. 청약철회(단순변심 포함)
• 전자상거래법에 따라 상품 수령일로부터 7일 이내 청약철회가 가능합니다.
• 예외: 포장 훼손/사용/가치 현저히 감소/맞춤 제작/복제가 가능한 상품 등 법령상 반환이 제한되는 경우
• 단순변심 반품의 왕복 배송비는 회원 부담입니다(하자/오배송은 회사 부담).

7. 교환/반품/환불
• 접수 절차: 마이페이지 또는 문의를 통해 신청 → 회수/검수 → 환불(원결제 취소 또는 계좌 환불)
• 환불 기한: 회수 완료 및 검수 후 관련 법령에 따른 기한 내 처리
• 구성품/사은품 미반환, 훼손 등은 환불 금액에서 공제 또는 반품 거절 사유가 될 수 있습니다.

8. AS 및 제품 보증
• 제조사 보증 기준/기간에 따르며, 제품별 안내를 확인해 주세요.
• 소비자 과실/소모성 부품은 무상 AS 대상에서 제외될 수 있습니다.

9. 금지행위
• 타인 정보 도용, 포인트/쿠폰 부정 사용, 시스템 장애 유발, 허위 후기/허위 클레임 등

10. 책임제한 및 면책
• 회사는 통신장애/천재지변/불가항력으로 서비스를 제공하지 못한 경우 책임이 제한될 수 있습니다.
• 단, 회사의 고의·중과실이 있는 경우에는 그러하지 않습니다.

11. 약관 변경
• 법령 개정/서비스 정책 변경에 따라 약관이 개정될 수 있으며, 변경 전 7일(중요 변경 30일) 이상 공지합니다.
• 변경에 동의하지 않을 경우 회원은 언제든 탈퇴할 수 있습니다.

12. 관할
• 분쟁이 발생할 경우 관할법원은 민사소송법에 따릅니다.

※ 본 요약은 이해를 돕기 위한 안내이며, 상세 기준은 본문 약관/개별 정책/관련 법령에 따릅니다.`,

    // ② 전자금융서비스 이용약관 (필수)
    terms2: `【전자금융서비스 이용약관(요약)】
본 약관은 회사가 제공하는 전자지급결제대행(PG), 간편결제, 가상계좌 등 전자금융거래 이용에 관한 사항을 규정합니다.

1. 전자금융거래의 정의
• 회원이 전자적 장치를 이용하여 결제/환불 등을 처리하는 거래로, 거래 정보는 전자문서 형태로 보관됩니다.

2. 본인확인 및 안전성
• 결제 시 본인확인을 위해 비밀번호/OTP/문자인증 등이 요구될 수 있습니다.
• 회원은 결제수단(카드/계좌/간편결제 계정)과 인증수단을 안전하게 관리해야 합니다.

3. 거래지시 및 처리
• 회원의 결제 요청(거래지시)이 수신되면 지시에 맞게 처리하며, 승인 실패/한도 초과/시스템 장애 등으로 거래가 이루어지지 않을 수 있습니다.

4. 오류의 정정
• 거래내역에 오류가 있을 경우, 회원은 즉시 회사 또는 PG사에 정정을 요구할 수 있으며, 회사는 지체 없이 조사·정정합니다.

5. 영수증/내역 조회
• 마이페이지 또는 결제 알림(이메일/SMS)을 통해 내역 확인이 가능합니다. 필요 시 고객센터로 재발송을 요청할 수 있습니다.

6. 거래 취소 및 환불
• 전자상거래법/약관/개별 정책에 따라 승인 취소 또는 환불이 진행되며, 원결제 수단으로의 취소를 원칙으로 합니다.
• 가상계좌 입금 후 환불은 계좌정보 확인 절차가 필요할 수 있습니다.

7. 보안사고 및 책임
• 회사는 전자금융거래법 등 관계 법령에 따라 안전성 확보 조치를 시행합니다.
• 분실/도난/도용 등 사고가 발생한 경우, 회원은 즉시 신고해야 하며, 회사는 접수 즉시 결제 정지 등 필요한 조치를 합니다.
• 회원의 고의·중과실(비밀번호 공유, 관리 소홀 등)로 인한 손해는 회원에게 책임이 있을 수 있습니다.

8. 수수료 및 한도
• 결제수단별 수수료/한도는 PG사·카드사·은행 정책에 따라 달라질 수 있으며, 회사는 사전에 고지합니다.

9. 약관 변경 및 분쟁
• 약관은 법령/정책 변경 시 개정될 수 있으며, 분쟁은 관계 법령 및 관할법원에 따릅니다.`,

    // ③ 개인정보 수집 및 이용 동의 (필수)
    terms3: `【개인정보 수집·이용 동의(요약)】
회사는 회원가입/주문/배송/고객응대 등을 위해 최소한의 개인정보를 수집·이용합니다.

1. 수집 항목
• 필수: 성명, 아이디/이메일, 비밀번호, 휴대전화번호, 주소(배송), 결제 식별정보(거래 승인용)
• 선택: 마케팅 수신 동의 여부, 관심 카테고리, 쿠폰/포인트 알림 수단 등
• 자동수집: 접속 IP/기기정보/쿠키/서비스 이용기록(보안·이용 통계)

2. 이용 목적
• 회원 식별/가입 관리, 주문·결제 처리, 배송 및 AS, 민원 응대, 부정이용 방지, 서비스 개선/통계

3. 보유·이용 기간
• 회원 탈퇴 시 지체 없이 파기
• 단, 관련 법령에 따른 보존(거래기록 등)은 법정 기간 동안 별도 분리 보관 후 파기
  - 계약/청약철회/대금결제/재화공급 기록: 5년
  - 소비자 불만·분쟁처리 기록: 3년
  - 접속 로그/접속지 추적자료: 3개월(통신비밀보호법 등)

4. 제3자 제공/처리위탁
• 결제/배송/문자·이메일 발송/고객상담 등 서비스 수행을 위해 필요한 범위 내에서 위탁할 수 있으며, 수탁사와 처리 목적/기간/안전성 조치를 고지합니다.
• 법령 근거 또는 회원 동의 없이 무단으로 제3자에게 제공하지 않습니다.

5. 권리
• 회원은 언제든 자신의 개인정보 열람/정정/삭제/처리정지/동의철회를 요청할 수 있습니다.
• 필수 항목 동의를 거부하면 회원가입 또는 구매 서비스 이용이 제한될 수 있습니다.

6. 안전성 확보 조치
• 접근권한 통제, 암호화, 접속기록 보관, 내부 교육 등 관계 법령에 따른 기술·관리적 보호조치를 시행합니다.

※ 보다 자세한 내용은 개인정보처리방침 전문을 확인해 주세요.`,

    // ④ 만 14세 이상입니다 (필수)
    terms4: `【연령 확인(만 14세 이상)】
• 회원은 가입 시 본인이 만 14세 이상임을 확인해야 합니다.
• 만 14세 미만 아동은 법정대리인의 동의 없이 회원가입 및 결제가 제한됩니다.
• 허위로 가입·이용한 경우, 법정대리인은 가입 사실 확인 후 계약 취소/개인정보 삭제를 요청할 수 있으며, 회사는 관련 법령에 따라 지체 없이 조치합니다.`,

    // ⑤ 혜택 알림 수신 동의 (선택)
    terms5: `【마케팅 정보 수신 동의(선택)】
본 동의는 이벤트·쿠폰·신상품·세일 등 혜택 정보를 이메일·문자·앱 푸시로 받아보기 위한 선택 사항입니다.

1. 수신 내용/채널
• 내용: 할인/쿠폰, 이벤트, 맞춤 추천, 재입고/딜 알림 등
• 채널: 이메일, 문자(SMS/LMS), 앱 푸시(설치 시)

2. 개인정보 이용 항목
• 이메일/휴대폰번호, 수신 동의 여부, 기본 회원정보, 서비스 이용 기록(맞춤형 안내 목적)

3. 보유 및 이용 기간
• 동의 철회 또는 회원 탈퇴 시까지, 단 법령상 보존이 필요한 경우 예외적으로 보관

4. 제3자 처리위탁
• 발송 대행사/푸시 서비스 사업자 등에게 필요한 범위 내에서 위탁할 수 있으며, 수탁사는 개인정보 보호 의무를 준수합니다.

5. 동의 철회 방법
• 마이페이지 > 알림 수신 설정에서 언제든 변경 가능
• 이메일/문자 내 ‘수신거부’ 링크 클릭
• 고객센터를 통한 철회 요청

※ 미동의/철회하셔도 구매 서비스 이용에는 제한이 없습니다.`
  };

  // 모달 열기
  function openModal(key) {
    const modal = document.getElementById("modal");
    document.getElementById("modal-content").innerText = termsData[key] || "내용이 없습니다.";
    modal.classList.remove("hidden");
  }

  // 모달 닫기
  function closeModal() {
    document.getElementById("modal").classList.add("hidden");
  }
</script>

<!-- ✅ 간단한 fadeIn 효과 -->
<style>
@keyframes fadeIn { from { opacity: 0; transform: scale(0.97); } to { opacity: 1; transform: scale(1); } }
.animate-fadeIn { animation: fadeIn 0.25s ease-in-out; }
</style>

{% endblock %}
