{% extends "base.html" %}
{% block content %}
<!-- Shorts Section -->
<section class="relative w-full h-[500px] md:h-[800px] bg-[#f2f2f2] overflow-hidden">
  {% if latest_video %}
    <div class="relative w-full h-full">
      <!-- 영상 -->
      <video class="w-full h-full object-cover" autoplay muted loop playsinline>
        <source src="{{ url_for('serve_video', video_id=latest_video.id) }}" type="{{ latest_video.video_mime or 'video/mp4' }}">
      </video>

      <!-- ✅ 데스크탑 전용 오버레이 -->
      <div class="hidden sm:flex absolute top-0 left-0 h-full w-2/3 md:w-1/2
                  bg-gradient-to-r from-black/80 to-transparent
                  transform -translate-x-2/3 hover:translate-x-0
                  transition-transform duration-700 ease-in-out
                  items-center p-4 sm:p-6 text-white cursor-pointer">

        <div class="text-sm sm:text-base md:text-lg">
          <h2 class="text-lg sm:text-xl md:text-2xl font-bold text-white drop-shadow-[0_0_4px_rgba(0,0,0,0.8)] mb-2 sm:mb-3">{{ _(latest_video.title or " ") }}</h2>
          <p class="mb-3 sm:mb-4 text-gray-200 text-xs text-[#ddd] sm:text-sm md:text-base">{{ _(latest_video.description or " ") }}</p>
          <a href="/videos" 
             class="inline-block btn-dark px-5 py-2.5 rounded-full shadow hover:opacity-90 transition text-sm sm:text-base font-medium">
            {{ _("영상 더 보기 →") }}
          </a>
        </div>

        <!-- 세로 텍스트 안내 -->
        <div class="absolute top-1/2 right-2 sm:right-3 -translate-y-1/2
            [writing-mode:vertical-rl] rotate--180
            font-bold text-xs sm:text-sm md:text-lg tracking-wider
            text-white drop-shadow-[0_0_4px_rgba(0,0,0,0.8)]
            flex items-center gap-1 pointer-events-none">
            <span class="animate-bounce">▼</span>
            <span>{{ _("자세히 보기") }}</span>
        </div>
      </div>

      <!-- ✅ 모바일 전용 설명 박스 -->
      <div class="sm:hidden absolute bottom-0 left-0 w-full">
        <!-- 👇 흐림 그라데이션: 텍스트박스 바로 위 경계 부분만 -->
        <div class="absolute -top-10 left-0 w-full h-10 bg-gradient-to-b from-transparent via-black/30 to-black/60 pointer-events-none"></div>

        <!-- 텍스트 박스 -->
        <div class="relative bg-black/60 text-white px-4 pb-3 backdrop-blur-[2px]">
          <h2 class="text-base font-semibold mb-1">{{ _(latest_video.title or " ") }}</h2>
          <p class="text-xs text-gray-200 mb-2">{{ _(latest_video.description or " ") }}</p>
          <a href="/videos"
             class="inline-block bg-white text-black text-xs font-medium px-3 py-1.5 rounded-full shadow hover:bg-gray-200 transition">
            {{ _("영상 더 보기 →") }}
          </a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="flex items-center justify-center h-full text-black">
      <p>{{ _("아직 등록된 영상이 없습니다.") }}</p>
    </div>
  {% endif %}
</section>

<section class="bg-gray-50 max-w-full mx-auto px-4 sm:px-10 md:px-16 py-14 md:py-20 grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
  {% if ads and ads|length > 0 %}
    <!-- 왼쪽 텍스트 -->
    <div>
      <h2 class="text-3xl sm:text-4xl font-extrabold text-[#222] mb-4 sm:mb-4">
        {{ _(ads[0].title or " ") }}
      </h2>
      <p class="text-gray-600 mb-6 text-sm sm:text-base leading-relaxed">
        <strong class="text-lg">{{ _(ads[0].subtitle or " ") }}</strong><br>
        {{ _(ads[0].description or " ") }}
      </p>
      <a href="{{ ads[0].link_url or '/products' }}" target="_blank"
         class="inline-block btn-dark px-6 py-2 text-white rounded-full shadow hover:opacity-90 text-sm sm:text-base transition">
        {{ _("자세히 보러가기 →") }}
      </a>
    </div>

    <!-- 오른쪽 이미지 캐러셀 (데스크탑) -->
    <div class="hidden sm:flex relative w-full h-72 md:h-80 items-center justify-center overflow-hidden">
      <div id="ad-carousel-pc" class="relative w-full h-full flex items-center justify-center">
        {% for ad in ads %}
          {% for img in ad.images %}
            <img src="{{ url_for('ad_image', image_id=img.id) }}"
                alt="{{ ad.title }}"
                class="ad-slide w-[300px] md:w-[350px] absolute rounded-lg shadow">
          {% endfor %}
        {% endfor %}
      </div>
    </div>

    <!-- 모바일 전용 (스와이프) -->
    <div class="sm:hidden relative w-full h-80 overflow-x-auto">
      <div class="flex space-x-4 w-max px-4 snap-x snap-mandatory">
        {% for ad in ads %}
          {% for img in ad.images %}
            <img src="{{ url_for('ad_image', image_id=img.id) }}"
                alt="{{ ad.title }}"
                class="w-64 h-72 object-cover rounded-lg shadow snap-center flex-shrink-0">
          {% endfor %}
        {% endfor %}
      </div>
    </div>
  {% else %}
    <!-- 광고 없을 때 -->
    <div class="col-span-2 text-center text-gray-500 py-10">
      {{ _("등록된 광고가 없습니다.") }}
    </div>
  {% endif %}
</section>

<!-- Company Section -->
<section class="py-12 sm:py-16 text-center bg-white">
  <h2 class="text-3xl sm:text-4xl font-bold mb-5 text-[#222] sm:mb-6" style="font-family:'DesignHouse',sans-serif; font-weight:700; font-size:2rem;">{{ _("유가몰 소개") }}</h2>
  <p class="max-w-2xl mx-auto text-gray-600 text-sm sm:text-base leading-relaxed whitespace-pre-line">
    {{ _("유가몰은 누구나 편리하게 이용할 수 있는 의료용품 전문 스토어입니다.
일상에서 필요한 제품을 간편하게 만나보세요.
믿을 수 있는 품질, 합리적인 가격, 빠른 배송으로 여러분의 건강한 생활을 응원합니다 ") }}
  </p>
</section>

<!-- Contact Section -->
<section class="bg-[#f7f7f7] py-20 sm:py-16">
  <div class="max-w-3xl mx-auto px-4">
    <h2 class="text-3xl sm:text-4xl font-bold mb-8 text-center text-[#222]">{{ _("문의하기") }}</h2>
    <form method="POST" action="{{ url_for('contact') }}" class="bg-white shadow-lg rounded-2xl p-6 sm:p-8 space-y-5">

      {% if not current_user.is_authenticated %}
      <!-- ✅ 비회원일 경우 표시 -->
      <div>
        <label class="block text-sm font-semibold mb-1">{{ _("이메일 (필수)") }}</label>
        <input type="email" name="email" class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-[#007AFF]" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">{{ _("이름") }}</label>
        <input type="text" name="guest_name" class="w-full border border-gray-300 rounded-lg p-2.5">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">{{ _("전화번호") }}</label>
        <input type="text" name="guest_phone" class="w-full border border-gray-300 rounded-lg p-2.5">
      </div>
      {% endif %}

      <div>
        <label class="block text-sm font-semibold mb-1">{{ _("제목") }}</label>
        <input type="text" name="title" class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-[#007AFF]" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">{{ _("내용") }}</label>
        <textarea name="content" rows="5" class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-[#007AFF]" required></textarea>
      </div>
      <button type="submit" class="w-full btn-dark px-8 py-2.5 text-white rounded-full text-sm sm:text-base font-semibold shadow hover:opacity-90 transition">
        {{ _("보내기") }}
      </button>
    </form>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const slides = document.querySelectorAll(".ad-slide");
  if (slides.length === 0) return;

  let idx = 0;
  slides[0].classList.add("opacity-100");

  setInterval(() => {
    slides[idx].classList.remove("opacity-100");
    idx = (idx + 1) % slides.length;
    slides[idx].classList.add("opacity-100");
  }, 4000);
});
</script>

{% endblock %}
